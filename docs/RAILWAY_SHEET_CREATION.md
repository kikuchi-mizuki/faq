# Railway スプレッドシート自動作成ガイド

## 🎯 概要

Railwayの本番環境で認証システム用のスプレッドシートを自動作成する手順です。

## 🚀 実行手順

### **STEP1: Railwayダッシュボードにアクセス**

1. [Railway Dashboard](https://railway.app/dashboard) にアクセス
2. プロジェクトを選択
3. 「Deployments」タブをクリック

### **STEP2: スプレッドシート作成スクリプトの実行**

Railwayのコンソールで以下のコマンドを実行：

```bash
python railway_create_sheets.py
```

### **STEP3: 実行結果の確認**

以下のメッセージが表示されれば成功です：

```
✅ 認証システム用スプレッドシートの自動作成が完了しました！
📊 作成されたシート:
  - store_management (店舗管理)
  - staff_management (スタッフ管理)
🧪 次のステップ: Botの動作確認
```

## 📊 作成されるスプレッドシート

### **店舗管理シート（`store_management`）**

| 列 | 名前 | 説明 | 例 |
|----|------|------|---|
| A | store_code | 店舗コード | STORE001 |
| B | store_name | 店舗名 | 本店 |
| C | status | ステータス | active |
| D | created_at | 作成日時 | 2025-01-13T10:00:00Z |
| E | last_activity | 最終利用日時 | 2025-01-13T15:30:00Z |
| F | notes | 備考 | 本店 |
| G | admin_notes | 管理者メモ | 特記事項なし |
| H | contact_info | 連絡先情報 | 03-1234-5678 |
| I | location | 店舗所在地 | 東京都渋谷区 |
| J | manager_name | 店舗責任者名 | 田中太郎 |

### **スタッフ管理シート（`staff_management`）**

| 列 | 名前 | 説明 | 例 |
|----|------|------|---|
| A | store_code | 店舗コード | STORE001 |
| B | staff_id | 社員番号 | 001 |
| C | staff_name | スタッフ名 | 田中太郎 |
| D | position | 役職 | 店長 |
| E | status | ステータス | active |
| F | created_at | 作成日時 | 2025-01-13T10:00:00Z |
| G | last_activity | 最終利用日時 | 2025-01-13T15:30:00Z |
| H | line_user_id | LINEユーザーID | U1234567890abcdef |
| I | auth_time | 認証日時 | 2025-01-13T10:30:00Z |
| J | notes | 備考 | 本店店長 |

## 🧪 テストデータ

### **店舗データ**

```
STORE001,本店,active,2025-01-13T10:00:00Z,,本店,,03-1234-5678,東京都渋谷区,田中太郎
STORE002,渋谷店,active,2025-01-13T10:00:00Z,,渋谷店,,03-2345-6789,東京都渋谷区,佐藤花子
STORE003,新宿店,suspended,2025-01-13T10:00:00Z,,新宿店（一時休業）,,03-3456-7890,東京都新宿区,鈴木一郎
```

### **スタッフデータ**

```
STORE001,001,田中太郎,店長,active,2025-01-13T10:00:00Z,,,,
STORE001,002,山田花子,スタッフ,active,2025-01-13T10:00:00Z,,,,
STORE002,003,佐藤花子,店長,active,2025-01-13T10:00:00Z,,,,
STORE002,004,鈴木一郎,スタッフ,suspended,2025-01-13T10:00:00Z,,,,
```

## 🔧 トラブルシューティング

### **よくある問題**

#### **1. 環境変数が設定されていない**
```
❌ 必要な環境変数が設定されていません
```

**解決方法**: Railwayダッシュボードで以下の環境変数を設定：
- `GOOGLE_SERVICE_ACCOUNT_JSON`
- `SHEET_ID_QA`

#### **2. Google認証情報の取得に失敗**
```
❌ Google認証情報が取得できませんでした
```

**解決方法**: 
- `GOOGLE_SERVICE_ACCOUNT_JSON`の設定を確認
- サービスアカウントの権限を確認

#### **3. スプレッドシートにアクセスできない**
```
❌ スプレッドシートを開けませんでした
```

**解決方法**:
- `SHEET_ID_QA`の設定を確認
- サービスアカウントにスプレッドシートの編集権限を付与

## 📋 実行後の確認事項

- [ ] 店舗管理シートが作成されている
- [ ] スタッフ管理シートが作成されている
- [ ] ヘッダー行が正しく設定されている
- [ ] サンプルデータが投入されている
- [ ] エラーメッセージが表示されていない

## 🎯 次のステップ

スプレッドシートの作成が完了したら：

1. **Botの動作確認**
2. **認証フローのテスト**
3. **認証済みユーザーのBot利用確認**

---

## 🎉 完了！

スプレッドシートの自動作成が完了したら、認証システムが完全に動作するようになります！
