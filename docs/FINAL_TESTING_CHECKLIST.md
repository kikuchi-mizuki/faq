# 最終テストチェックリスト

## 🎯 概要

認証システムが実装されたLINE Botの最終テスト手順です。

## 🚀 テスト手順

### **STEP1: システム起動確認**

#### **1.1 Railwayでの動作確認**
- [ ] アプリケーションが正常に起動している
- [ ] ヘルスチェック（`/healthz`）が200レスポンス
- [ ] ログにエラーが発生していない

#### **1.2 スプレッドシートの確認**
- [ ] 店舗管理シート（`store_management`）が存在する
- [ ] スタッフ管理シート（`staff_management`）が存在する
- [ ] サンプルデータが正しく投入されている

### **STEP2: 認証システムのテスト**

#### **2.1 未認証ユーザーのテスト**
1. **LINE Botにメッセージを送信**
   - 任意のメッセージを送信

2. **期待される応答**
   ```
   このBotは関係者専用です。

   スタッフの方は「認証」と入力して認証を行ってください。
   不明な点は管理者にお問い合わせください。
   ```

3. **確認事項**
   - [ ] 制限メッセージが表示される
   - [ ] 認証手順が案内される

#### **2.2 認証フローのテスト**

1. **認証開始**
   - 「認証」と入力

2. **期待される応答**
   ```
   Botをご利用いただくには認証が必要です。

   「認証する」ボタンを押してLINEログインしてください。
   ```

3. **認証ボタンの表示**
   - [ ] 「認証する」ボタンが表示される

4. **店舗コード入力**
   - 「店舗コード:STORE001」と入力

5. **期待される応答**
   ```
   店舗コードを入力してください。

   例：店舗コード:A123
   ```

6. **社員番号入力**
   - 「社員番号:001」と入力

7. **期待される応答**
   ```
   社員番号を入力してください。

   例：社員番号:001
   ```

8. **認証成功**
   - [ ] 認証成功メッセージが表示される
   - [ ] 店舗名・スタッフ名が表示される

#### **2.3 認証済みユーザーのテスト**

1. **Q&A検索のテスト**
   - 「修正は何回まで可能ですか？」と入力
   - [ ] 適切な回答が返される

2. **分岐会話のテスト**
   - 「月次締め」と入力
   - [ ] 分岐会話が開始される

3. **通常のBot機能のテスト**
   - [ ] 各種質問に対して適切な回答が返される

### **STEP3: エラーケースのテスト**

#### **3.1 認証失敗のテスト**

1. **存在しない店舗コード**
   - 「店舗コード:INVALID」と入力
   - [ ] エラーメッセージが表示される

2. **存在しない社員番号**
   - 「社員番号:999」と入力
   - [ ] エラーメッセージが表示される

3. **認証試行回数制限**
   - 3回連続で認証に失敗
   - [ ] 認証が一時的に無効化される

#### **3.2 権限のテスト**

1. **停止中の店舗**
   - STORE003（suspended）で認証を試行
   - [ ] 認証が失敗する

2. **停止中のスタッフ**
   - 停止中のスタッフで認証を試行
   - [ ] 認証が失敗する

### **STEP4: パフォーマンステスト**

#### **4.1 応答時間の確認**

1. **認証フローの応答時間**
   - [ ] 各ステップで2秒以内に応答

2. **Q&A検索の応答時間**
   - [ ] 質問に対して2秒以内に回答

#### **4.2 同時接続のテスト**

1. **複数ユーザーの同時認証**
   - [ ] 複数のユーザーが同時に認証を試行
   - [ ] 正常に処理される

2. **認証済みユーザーの同時利用**
   - [ ] 複数の認証済みユーザーが同時にBotを利用
   - [ ] 正常に処理される

## 📊 確認完了チェックリスト

### **システム確認**
- [ ] Railwayアプリケーションが正常に起動
- [ ] ヘルスチェックが正常に応答
- [ ] ログにエラーが発生していない
- [ ] スプレッドシートが正しく作成されている

### **認証システム確認**
- [ ] 未認証ユーザーに制限メッセージが表示
- [ ] 認証フローが正常に動作
- [ ] 認証済みユーザーがBotを利用可能
- [ ] エラーケースが適切に処理

### **Bot機能確認**
- [ ] Q&A検索が正常に動作
- [ ] 分岐会話が正常に動作
- [ ] 応答時間が2秒以内
- [ ] 同時接続が正常に処理

## 🎯 テスト完了後の次のステップ

1. **本番運用開始**
2. **ユーザー向けトレーニング**
3. **管理者向けトレーニング**
4. **運用マニュアルの配布**

---

## 🎉 テスト完了！

全てのテストが完了したら、フランチャイズ店舗のスタッフが安全にBotを利用できるようになります！
